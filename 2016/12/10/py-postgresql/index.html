<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="java"><title>py-postgresql 基本操作 | Gloria</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">py-postgresql 基本操作</h1><a id="logo" href="/.">Gloria</a><p class="description">Java开发工程师</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/collection/"><i class="fa fa-archive"> 资料收集</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">py-postgresql 基本操作</h1><div class="post-meta">Dec 10, 2016<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p>###创建连接</p>
<h5 id="详细config配置参见官方文档中Connection-Keywords部分"><a href="#详细config配置参见官方文档中Connection-Keywords部分" class="headerlink" title="详细config配置参见官方文档中Connection Keywords部分"></a>详细config配置参见<a href="http://python.projects.pgfoundry.org/docs/1.1/driver.html" target="_blank" rel="external">官方文档</a>中<em>Connection Keywords</em>部分</h5><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">config = &#123;</div><div class="line">'user': 'username',</div><div class="line">'password': 'password',</div><div class="line">'host': 'localhost',</div><div class="line">'port': 5432,</div><div class="line">'database': 'postgres'</div><div class="line">&#125;</div><div class="line">db = pg_driver.connect(**config)</div></pre></td></tr></table></figure>
<h3 id="表创建"><a href="#表创建" class="headerlink" title="表创建"></a>表创建</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">ps = db.prepare("""</div><div class="line">     <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> employee (</div><div class="line">         employee_name <span class="built_in">text</span>,</div><div class="line">         employee_salary <span class="built_in">numeric</span>,</div><div class="line">         employee_dob <span class="built_in">date</span>,</div><div class="line">         employee_hire_date <span class="built_in">date</span></div><div class="line">     );</div><div class="line"> """)</div><div class="line">ps()</div></pre></td></tr></table></figure>
<h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">  from datetime import date, datetime</div><div class="line">  mkemp = db.prepare("<span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee <span class="keyword">VALUES</span> ($<span class="number">1</span>, $<span class="number">2</span>, $<span class="number">3</span>, $<span class="number">4</span>)<span class="string">")</span></div><div class="line">--单行插入</div><div class="line">  rs = mkemp(</div><div class="line">      "John Johnson<span class="string">",</span></div><div class="line">      "<span class="number">92000</span><span class="string">",</span></div><div class="line">      date(1950, 12, 10),</div><div class="line">      date(1998, 4, 23)</div><div class="line">  )</div><div class="line">&gt; ('INSERT', 1) --'INSERT'为操作类型，1为影响行数</div><div class="line"></div><div class="line">--多行插入</div><div class="line">  mkemp.load_rows([</div><div class="line">      ("Jack Johnson<span class="string">", "</span><span class="number">85000</span><span class="string">", date(1962, 11, 23), date(1990, 3, 5)),</span></div><div class="line">      ("Debra McGuffer<span class="string">", "</span><span class="number">52000</span><span class="string">", date(1973, 3, 4), date(2002, 1, 14)),</span></div><div class="line">      ("Barbara Smith<span class="string">", "</span><span class="number">86000</span><span class="string">", date(1965, 2, 24), date(2005, 7, 19)),</span></div><div class="line">  ])</div></pre></td></tr></table></figure>
<h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">  ps = db.prepare("<span class="keyword">select</span> * <span class="keyword">from</span> employee<span class="string">")</span></div><div class="line">  rs = ps()</div><div class="line">  print(rs)</div><div class="line"></div><div class="line">&gt; [('Jack Johnson', Decimal('85000'), datetime.date(1962, 11, 23), datetime.date(1990, 3, 5)), ('Debra McGuffer', Decimal('52000'), datetime.date(1973, 3, 4), datetime.date(2002, 1, 14)), ('Barbara Smith', Decimal('86000'), datetime.date(1965, 2, 24), datetime.date(2005, 7, 19)), ('John Johnson', Decimal('92000'), datetime.date(1950, 12, 10), datetime.date(1998, 4, 23))]</div></pre></td></tr></table></figure>
<h5 id="查询结果遍历-取值方式，结果为list结构"><a href="#查询结果遍历-取值方式，结果为list结构" class="headerlink" title="查询结果遍历/取值方式，结果为list结构"></a>查询结果遍历/取值方式，结果为list结构</h5><ol>
<li><p>整行遍历</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">    for row in rs:</div><div class="line">        print(row)</div><div class="line"></div><div class="line">&gt; ('Jack Johnson', Decimal('85000'), datetime.date(1962, 11, 23), datetime.date(1990, 3, 5))</div><div class="line">&gt; ('Debra McGuffer', Decimal('52000'), datetime.date(1973, 3, 4), datetime.date(2002, 1, 14))</div><div class="line">&gt; ('Barbara Smith', Decimal('86000'), datetime.date(1965, 2, 24), datetime.date(2005, 7, 19))</div><div class="line">&gt; ('John Johnson', Decimal('92000'), datetime.date(1950, 12, 10), datetime.date(1998, 4, 23))</div></pre></td></tr></table></figure>
</li>
<li><p>输出每行指定位置的值</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">--下表从0开始</div><div class="line">    for row in rs:</div><div class="line">        print(row[0])</div><div class="line"></div><div class="line">&gt; Jack Johnson</div><div class="line">&gt; Debra McGuffer</div><div class="line">&gt; Barbara Smith</div><div class="line">&gt; John Johnson</div></pre></td></tr></table></figure>
</li>
<li><p>输出每行指定字段的值  </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">    for row in rs:</div><div class="line">        print(row['employee_name'])</div><div class="line"></div><div class="line">&gt; Jack Johnson</div><div class="line">&gt; Debra McGuffer</div><div class="line">&gt; Barbara Smith</div><div class="line">&gt; John Johnson</div></pre></td></tr></table></figure>
</li>
<li><p>迭代行中的key-value</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">    row = db.prepare("<span class="keyword">select</span> * <span class="keyword">from</span> employee<span class="string">").first()</span></div><div class="line">    for k, v in row.items():</div><div class="line">        print(k + "=<span class="string">" + str(v))</span></div><div class="line"></div><div class="line">&gt; employee_name=Jack Johnson</div><div class="line">&gt; employee_salary=85000</div><div class="line">&gt; employee_dob=1962-11-23</div><div class="line">&gt; employee_hire_date=1990-03-05</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">    ps = db.prepare("<span class="keyword">update</span> employee <span class="keyword">set</span> employee_name=<span class="string">'gloria'</span>  <span class="keyword">where</span> employee_dob=$<span class="number">1</span><span class="string">")</span></div><div class="line">    rs = ps(date(1962, 11, 23))</div><div class="line">    print(rs())</div><div class="line"></div><div class="line">&gt; ('UPDATE', 1)</div></pre></td></tr></table></figure>
</div><script type="text/javascript" src="/js/share.js?v=1.0.0" async></script><a data-url="https://gloriabing.github.io/2016/12/10/py-postgresql/" data-id="ciznx1xcg000jw1x3s5ky00hi" class="article-share-link">分享到</a><div class="tags"></div><div class="post-nav"><a href="/2016/12/11/sohu-parser/" class="pre">sohu视频地址破解</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/开发规范/" style="font-size: 15px;">开发规范</a> <a href="/tags/leetcode/" style="font-size: 15px;">leetcode</a> <a href="/tags/视频播放地址破解/" style="font-size: 15px;">视频播放地址破解</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/02/27/Japan-Journey/">日本8日游</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/Alibaba-Java-Developers-Guide-Security/">阿里巴巴JAVA 开发手册 --- 安全规约</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/Alibaba-Java-Developers-Guide-Project/">阿里巴巴JAVA 开发手册 --- 工程规约</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/Alibaba-Java-Developers-Guide-MYSQL/">阿里巴巴JAVA 开发手册 --- MYSQL规约</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/Alibaba-Java-Developers-Guide-Exception/">阿里巴巴JAVA 开发手册 --- 异常日志</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/18/Alibaba-Java-Developers-Guide-Programming/">阿里巴巴JAVA 开发手册 --- 编程规约</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/30/Leetcode-Roman-to-Integer/">Leetcode 13. Roman to Integer 解题报告</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/22/divide-two-integers/">Divide Two Integers</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/16/mgtv-parser/">芒果TV视频播放地址破解</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/11/sohu-parser/">sohu视频地址破解</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://blog.csdn.net/gloria__zhang" title="csdn博客" target="_blank">csdn博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Gloria.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>